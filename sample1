def get_job_status(job_data):
    """Robust status detection from multiple fields"""
    if job_data.get('finished'):
        return job_data.get('status', 'unknown')
    
    if job_data.get('failed'):
        return 'failed'
    
    summary = job_data.get('summary_fields', {})
    if summary.get('job_events', {}).get('failed', 0) > 0:
        return 'failed'
    
    if summary.get('job_events', {}).get('changed', 0) > 0:
        return 'running'
    
    return job_data.get('status', 'pending')  # Default fallback



         # Use robust status detection
                current_status = get_job_status(job_data)
