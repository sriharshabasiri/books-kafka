DECLARE
    v_sql      VARCHAR2(4000);
    v_rowcount NUMBER;
BEGIN
    FOR t IN (
        SELECT owner AS schema_name, table_name 
        FROM all_tables 
        WHERE owner NOT IN ('SYS', 'SYSTEM')
    ) LOOP
        -- Dynamically generate and execute the count query
        v_sql := 'SELECT COUNT(*) FROM ' || t.schema_name || '.' || t.table_name;
        EXECUTE IMMEDIATE v_sql INTO v_rowcount;
        
        -- Output the result
        DBMS_OUTPUT.PUT_LINE('Schema: ' || t.schema_name || 
                             ', Table: ' || t.table_name || 
                             ', Row Count: ' || v_rowcount);
    END LOOP;
END;
/
